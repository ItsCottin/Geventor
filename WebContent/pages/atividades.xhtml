<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/WEB-INF/template/layoutV2.xhtml">
	
	<ui:define name="contentV2">

		<script type="text/javascript">
			function onCompleteSave(xhr, status, args) {
				if (!args.validationFailed) {
					PF('dlgAdicionarAtiv').hide();
				}
			}
		</script>
		<p:growl id="msgs" showDetail="false" autoUpdate="true" sticky="false"
			life="7500" />


		<p:tabView dynamic="true" id="tabGerencAtiv">
			<p:tab title="Gerenciar" id="gerencAtiv">
			<h1 class="">Atividades</h1>
				<p:separator style="width:99%;" />
				<div class="col py-3 px-md-5 border bg-light">
				<table>
				<TBODY>
				<tr>
				<td class="col-md-5">
				<p:commandButton oncomplete="PF('dlgAdicionarAtiv').show();"
					process="@this" value="ADICIONAR"
					update="form:dlgAdicionarAtiv"
					styleClass=""
					actionListener="#{atividadeMB.doPrepareInsert}">
					<p:ajaxStatus onstart="PF('status').show()"
						onsuccess="PF('status').hide()" />
				</p:commandButton>
				</td><td class="col-md-3">
				<p:outputLabel value="Seus eventos: " styleClass="rcf-input-form" /></td><td class="col-md-4">
				<p:selectOneMenu styname="eventos" id="eventos"
					styleClass="" label="Eventos"
					value="#{atividadeMB.idEvento}" style="width:125px">
					<f:ajax listener="#{atividadeMB.onEventoChange}"
						render="tblAtiv" update="form:tabGerencAtiv:j_idt41" />
					<f:selectItem itemValue="" itemLabel="Selecione um Evento"
						noSelectionOption="true" />
					<f:selectItems value="#{eventoMB.resultadoEvento}" var="event"
						itemLabel="#{event.titulo}" itemValue="#{event.id}" />
				</p:selectOneMenu></td>
				</tr>
				</TBODY>
				</table>
				</div>
				<div class="col py-3 px-md-5 border bg-light">
					<h:panelGroup id="tblAtiv">
						<p:dataTable var="ativ" value="#{atividadeMB.resultadoAtividadeByEvento}" >
				        <p:column headerText="Nome">
				            <h:outputText value="#{ativ.nome}" />
				        </p:column>
				        <p:column headerText="Data Inicio">
				            <h:outputText value="#{ativ.dataInicio}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
				        </p:column>
				        <p:column headerText="Data Fim">
				            <h:outputText value="#{ativ.dataInicio}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
				        </p:column>
				        <p:column headerText="Preço">
				            <h:outputText value="#{ativ.preco}" />
				        </p:column>
				        <p:column headerText="Vagas">
				            <h:outputText value="#{ativ.vagas}" />
				        </p:column>
				        <p:column headerText="Detalhes">
				            <h:outputText value="#{ativ.detalhes}" />
				        </p:column>
				        <p:column headerText="Ações">
				            <p:commandButton immediate="true" icon="ui-icon-wrench"
								title="Editar" actionListener="#{atividadeMB.doEdit(ativ)}"
								update=":msgs form:dlgAdicionarAtiv" process="@this"
								oncomplete="PF('dlgAdicionarAtiv').show()">
							</p:commandButton> 
							<p:commandButton immediate="true" icon="ui-icon-trash"
								title="Excluir" actionListener="#{atividadeMB.doRemove(ativ)}"
								update=":msgs form:tabGerencAtiv:j_idt40" render="tblAtiv">
								<p:confirm header="Confirmação"
									message="Tem certeza que você quer deletar?"
									icon="ui-icon-alert" />
							</p:commandButton>
				        </p:column>
				    </p:dataTable>
				  </h:panelGroup>
				</div>
			<!--
			<table class="table table-bordered">
				<tr>
					<th>Nome</th>
					<th>Data Inicio</th>
					<th>Data Fim</th>
					<th>Preço</th>
					<th>Vagas</th>
					<th>Detalhes</th>
					<th>Ações</th>
				</tr>
				<c:forEach items="#{atividadeMB.resultadoAtividadeByEvento}"
					var="ativ">
					<tr>
						<td>#{ativ.nome}</td>
						<td>
							<h:outputText value="#{ativ.dataInicio}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</td>
						<td>
							<h:outputText value="#{ativ.dataFim}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</td>
						<td>
							<h:outputText value="#{ativ.preco}" />
						</td>
						<td>
							<h:outputText value="#{ativ.vagas}" />
						</td>
						<td>
							<h:outputText value="#{ativ.detalhes}" />
						</td>
						<td>
							<p:commandButton immediate="true" icon="ui-icon-wrench"
								title="Editar" actionListener="#{atividadeMB.doEdit(ativ)}"
								update=":msgs form:dlgAdicionarAtiv" process="@this"
								oncomplete="PF('dlgAdicionarAtiv').show()">
							</p:commandButton> 
							<p:commandButton immediate="true" icon="ui-icon-trash"
								title="Excluir" actionListener="#{atividadeMB.doRemove(ativ)}"
								update=":msgs form:tblAtiv">
								<p:confirm header="Confirmação"
									message="Tem certeza que você quer deletar?"
									icon="ui-icon-alert" />
							</p:commandButton>
						</td>
					</tr>
				</c:forEach>
				<h:panelGroup id="tblFoster">
				<tr id="tblFoster" style="#{atividadeMB.resultadoAtividadeByEvento eq null ? 'display:true;' : 'display:none;'}">
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
					<td>
						<h:outputText value="sem atividade" />
					</td>
				</tr>
				</h:panelGroup>
			</table>
			-->
	
	</p:tab>
	</p:tabView>
		<p:dialog widgetVar="dlgAdicionarAtiv"
			header="#{atividadeMB.editAtividade.id eq null ? 'Adicionar nova atividade' : 'Editar atividade'}"
			modal="true" id="dlgAdicionarAtiv" styleClass="rcf-dialog">
			<p:panel id="pnlGridAtiv">
				<div class="col py-3 px-md-5 border bg-light">
						<p:inputText styleClass="ui-input-login col-12" placeholder="Nome da Atividade do Evento"
							value="#{atividadeMB.editAtividade.nome}" required="true"
							label="Nome da atividade" />
				</div>
				<div class="col py-3 px-md-5 border bg-light">
					<p:outputLabel value="Data Inicio" styleClass="rcf-input-form col-md-2" />
						<p:inputText pt:type="date" styleClass="rcf-input-form col-md-4"
							value="#{atividadeMB.editAtividade.dataInicio}" required="true"
							label="Data Inicio">
							<f:convertDateTime pattern="yyyy-MM-dd" />
						</p:inputText>
					</div>
					<div class="col py-3 px-md-5 border bg-light">
						<p:outputLabel value="Data Fim" styleClass="rcf-input-form col-md-2" />
						<p:inputText pt:type="date" styleClass="rcf-input-form col-md-4"
							value="#{atividadeMB.editAtividade.dataFim}" required="true"
							label="Data Término">
							<f:convertDateTime pattern="yyyy-MM-dd" />
						</p:inputText>
					</div>
					<div class="col py-3 px-md-5 border bg-light">
						<div class="col-md-12">
						<p:outputLabel value="Hora inicio" styleClass="rcf-input-form col-md-2" />
						<p:calendar pattern="HH:mm" timeOnly="true" styleClass="col-md-4"
							value="#{atividadeMB.editAtividade.horaInicio}" required="true"
							label="Hora inicio" />
						</div>
						<div class="col-md-12">
						<p:outputLabel value="Hora Fim" styleClass="rcf-input-form col-md-2" />
						<p:calendar pattern="HH:mm" timeOnly="true" styleClass="col-md-4"
							value="#{atividadeMB.editAtividade.horaFim}" required="true"
							label="Hora fim" />
						</div>
					</div>
					<div class="col py-3 px-md-5 border bg-light">
					<TABLE>
						<TBODY>
						<tr>
						<td class="col-md-3">
						<p:inputMask pt:type="" styleClass="rcf-input-form col-12" label="Preço" placeholder="Preço"
							mask="R$ 999,99" value="#{atividadeMB.editAtividade.preco}" />
						</td>
						<td class="col-md-3">
						<p:outputLabel value="Vagas" styleClass="rcf-input-form col-12" />
						</td>
						<td class="col-md-3">
						<p:inputText pt:type="" styleClass="rcf-input-form col-12"
							value="#{atividadeMB.editAtividade.vagas}" label="Vagas" />
						</td>
							</tr>
							</TBODY>
						</TABLE>
					</div>
					<div class="col py-3 px-md-5 border bg-light">
						<p:inputTextarea pt:type="" styleClass="rcf-input-form col-12"
							value="#{atividadeMB.editAtividade.detalhes}" label="Detalhes" placeholder="Detalhes da Atividade" />
						</div>
					<f:facet name="footer">
					<p:commandButton value="#{atividadeMB.editAtividade.id eq null ? 'Salvar' : 'Editar'}"
						styleClass=""
						actionListener="#{atividadeMB.doSave}"
						oncomplete="onCompleteSave(xhr, status, args);" update=":msgs form:tabGerencAtiv:j_idt40">
						<p:ajaxStatus onstart="PF('status').show()"
							onsuccess="PF('status').hide()" />
						<f:ajax render="tblAtiv"/>
					</p:commandButton>
					</f:facet>
					</p:panel>
				
		</p:dialog>
		<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
			<f:ajax render="tblAtiv">
			<p:commandButton value="Sim" type="button" update="form:tabGerencAtiv:j_idt40"
				styleClass="ui-confirmdialog-yes" icon="ui-icon-check">
				<p:ajaxStatus onstart="PF('status').show()"
							onsuccess="PF('status').hide()" />
			</p:commandButton>
			<p:commandButton value="Não" type="button"
				styleClass="ui-confirmdialog-no" icon="ui-icon-close" >
				<p:ajaxStatus onstart="PF('status').show()"
							onsuccess="PF('status').hide()" />
			</p:commandButton>
			</f:ajax>
		</p:confirmDialog>
		<p:dialog widgetVar="status" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false">
			<p:graphicImage name="ajaxloader.gif" library="images" />
		</p:dialog>
	</ui:define>
</ui:composition>