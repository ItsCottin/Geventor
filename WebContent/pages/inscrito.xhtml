<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/WEB-INF/template/layoutV3.xhtml">
	<ui:define name="contentV3">
		<ul class="nav nav-tab">
	         <li class="nav-tab-item active">
	            <a data-tab="tab-1" data-toggle="pill" class="nav-tab-link nav-link tab active" aria-current="page" href="#inscritos">Instritos</a>
	         </li>
	         <li class="nav-tab-item">
	            <a data-tab="tab-2" data-toggle="pill" class="nav-tab-link nav-link tab" href="#minhasinscricoes">Minhas Inscrições</a>
	         </li>
      	</ul>
		<div class="tab-content py-4">
	        <div id="inscritos" class="tab-pane active">
	         	<div class="form-group">
     	 		  	<h3 class="">Inscritos</h3>
     	 		 </div>
                 <h:form id="formtblinsc">
                 	<div class="${fn:length(usuarioAtividadeMB.usuAtiv) > 0 ? '' : 'd-flex justify-content-center align-items-center'}">
                 	<c:choose>
		             <c:when test="${fn:length(usuarioAtividadeMB.usuAtiv) > 0}">
		               	<table class="table-hover table-rcf-shadow">
						  <thead>
						    <tr>
						      <th scope="col">Atividade</th>
						      <th scope="col">Inscrito</th>
						      <th scope="col">Status</th>
						      <th scope="col">Gerenciar</th>
						    </tr>
						  </thead>
						  <tbody>
						  	<c:forEach var="insc" items="#{usuarioAtividadeMB.usuAtiv}" step="1" begin="0">
							    <tr>
							      <td data-label="Atividade" class="text-truncate">
								      	<p:commandButton immediate="true"
											icon="ui-icon-search" title="Consultar"
											actionListener="#{atividadeMB.prepareEditOuConsulta(insc.atividade)}" update=":formHtmlModal"
											process="@this" oncomplete="openModal('modalConsAtividade')" styleClass="ui-icon-button-rcf mx-2">
										</p:commandButton>
									#{insc.atividade.nome}
							      </td>
							      <td data-label="Inscrito" class="text-truncate">
								      	<p:commandButton immediate="true"
											icon="ui-icon-search" title="Consultar"
											actionListener="#{usuarioAtividadeMB.doConsultaUsuario(insc.usuario)}" update="formModalConsUsuario"
											process="@this" oncomplete="openModal('modalConsUsuario')" styleClass="ui-icon-button-rcf mx-2">
										</p:commandButton>
									#{insc.usuario.nome}
								  </td>
							      <td data-label="Status" class="#{insc.status eq 'Aprovado' ? 'text-primary' : (insc.status eq 'Reprovado' ? 'text-danger' : 'text-warning')}">#{insc.status}</td>
							      <td data-label="Gerenciar">
							      	<p:commandButton immediate="true"
										icon="ui-icon-check" title="Aprovar" disabled="#{insc.status eq 'Aprovado' ? 'true' : (insc.status eq 'Pendente' ? 'false' : 'false')}"
										actionListener="#{usuarioAtividadeMB.doEdit({'usuAtiv': insc, 'status': 'Aprovado'})}" update=":formtblinsc"
										process="@this" oncomplete="" styleClass="ui-icon-button-rcf">
									</p:commandButton>
		                           	<p:commandButton immediate="true"
										icon="ui-icon-closethick" title="Reprovar" disabled="#{insc.status eq 'Aprovado' ? 'false' : (insc.status eq 'Pendente' ? 'false' : 'true')}"
										actionListener="#{usuarioAtividadeMB.doEdit({'usuAtiv': insc, 'status': 'Reprovado'})}" update=":formtblinsc"
										process="@this" oncomplete="" styleClass="ui-icon-button-rcf">
									</p:commandButton>
	                                 
								  </td>
							    </tr>
						    </c:forEach>
						  </tbody>
						</table>
		              </c:when>
		              <c:otherwise>
		                <div class="alert alert-warning d-flex justify-content-center align-items-center" role="alert">
							Não existe nenhum 'Inscrito' nas Atividades dos seus Eventos, divulgue seus Eventos para que as pessoas se 'Inscrevam'.
						</div>
				      </c:otherwise>
					</c:choose>
                  	</div>
                  </h:form>
                  
	         
	        </div>
         	<div id="minhasinscricoes" class="tab-pane">
	         	<div class="form-group">
     	 		  	<h3 class="">Minhas Inscrições</h3>
     	 		 </div> 	
     	 		 <h:form id="formtblmyinsc">
     	 		 	<div class="${fn:length(usuarioAtividadeMB.myInscricoes) > 0 ? '' : 'd-flex justify-content-center align-items-center'}">
     	 		 	<c:choose>
		             <c:when test="${fn:length(usuarioAtividadeMB.myInscricoes) > 0}">
		               <table class="table-hover table-rcf-shadow">
						  <thead>
						    <tr>
						      <th scope="col">Atividade</th>
						      <th scope="col">Status</th>
						      <th scope="col">Gerenciar</th>
						    </tr>
						  </thead>
						  <tbody>
						  	<c:forEach var="insc" items="#{usuarioAtividadeMB.myInscricoes}" step="1" begin="0">
							    <tr>
							      <td data-label="Atividade" class="text-truncate">
							      	<p:commandButton immediate="true"
										icon="ui-icon-search" title="Consultar"
										actionListener="#{atividadeMB.prepareEditOuConsulta(insc.atividade)}" update=":formHtmlModal"
										process="@this" oncomplete="openModal('modalConsAtividade')" styleClass="ui-icon-button-rcf mx-2">
									</p:commandButton>#{insc.atividade.nome}
							      </td>
							      <td data-label="Status" class="#{insc.status eq 'Aprovado' ? 'text-primary' : (insc.status eq 'Reprovado' ? 'text-danger' : 'text-warning')}">#{insc.status}</td>
							      <td data-label="Gerenciar">
							      	<p:commandButton immediate="true"
										icon="ui-icon-closethick" title="Desistir"
										actionListener="#{usuarioAtividadeMB.doDelete(insc)}" update=":formtblmyinsc"
										process="@this" oncomplete="" styleClass="ui-icon-button-rcf">
									</p:commandButton>
								  </td>
							    </tr>
						    </c:forEach>
						  </tbody>
						</table>
		              </c:when>
		              <c:otherwise>
		                <div class="alert alert-warning d-flex justify-content-center align-items-center" role="alert">
							Você não está inscrito em nenhuma Atividade de nenhum Evento, vá para o menu de Eventos e descubra novos eventos de outros usuários.
						</div>
				      </c:otherwise>
					</c:choose>
     	 		  	</div>
                  </h:form>
	         	
	        </div>
	        <p:dialog widgetVar="status" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
                        <p:graphicImage name="ajaxloader.gif" library="images" />
                     </p:dialog>
                     <p:ajaxStatus onstart="PF('status').show()"
                        onsuccess="PF('status').hide()" />
             
             <!-- modal consulta atividade -->
					 <div class="modal fade" id="modalConsAtividade" tabindex="-1" role="dialog" aria-labelledby="confirmDel" aria-hidden="true">
						   <div class="modal-dialog modal-xl" role="document">
						      <div class="modal-content">
						      	<h:form id="formHtmlModal">
						         <div class="modal-header">
						            <h5 class="modal-title" id="exampleModalLabel">
						               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						               <span aria-hidden="true"></span>
						               </button>
						               <h:outputText value="Evento: #{atividadeMB.editAtividade.evento.titulo}" />
						            </h5>
						         </div>
						         <div class="modal-body">
						               <h3 class="mb-3">
						                  <h:outputText value="Atividade: #{atividadeMB.editAtividade.nome}" />
						               </h3>
						               <div class="col-md-12 col-lg-12">
						                  <div class="row mb-3 border-rcf">
						                     <div class="col-sm-12 row">
						                        <p class="font-weight-normal">
						                           <label><strong>Detalhes da Atividade:</strong> #{atividadeMB.editAtividade.detalhes}</label>
						                        </p>
						                     </div>
						                     <div class="col-sm-6 row">
						                        <p class="font-weight-normal">
						                           <label><strong>Começa:</strong> 
						                           	#{atividadeMB.formatarDataFromTela({'data': atividadeMB.editAtividade.dataInicio, 'formato': 'dd/MM'})} às #{atividadeMB.formatarDataFromTela({'data': atividadeMB.editAtividade.dataInicio, 'formato': 'HH:mm'})}
						                           </label>
						                        </p>
						                     </div>
						                     <div class="col-sm-6 row">
						                        <p class="font-weight-normal">
						                           <label><strong>Termina:</strong> 
						                           	#{atividadeMB.formatarDataFromTela({'data': atividadeMB.editAtividade.dataFim, 'formato': 'dd/MM'})} às #{atividadeMB.formatarDataFromTela({'data': atividadeMB.editAtividade.dataFim, 'formato': 'HH:mm'})}
						                           </label>
						                        </p>
						                     </div>
						                     <div class="col-sm-12">
						                        <div class="row">
						                           <p class="font-weight-normal">
						                              <label><strong>Preço:</strong> #{atividadeMB.editAtividade.preco}</label>
						                           </p>
						                        </div>
						                        <div class="row">
						                        	<p class="font-weight-normal">
						                              <label><strong>Vagas:</strong> #{atividadeMB.editAtividade.vagas - atividadeMB.editAtividade.qtdInscrito} de #{atividadeMB.editAtividade.vagas}</label>
						                            </p>
						                        </div>
						                     </div>
						                  </div>
						               </div>
						               <div class="col-md-12 col-lg-12 ui-padding-right-0-rcf">
						                  <div class="d-flex align-items-end flex-column">
								            <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
								         </div>
								       </div>
						         </div>
						         </h:form>
						      </div>
						   </div>
						</div>
						
						<!-- modal consulta Usuario -->
					 <div class="modal fade" id="modalConsUsuario" tabindex="-1" role="dialog" aria-labelledby="confirmDel" aria-hidden="true">
						   <div class="modal-dialog modal-xl" role="document">
						      <div class="modal-content">
						      	<h:form id="formModalConsUsuario">
						         <div class="modal-header">
						            <h5 class="modal-title" id="exampleModalLabel">
						               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						               <span aria-hidden="true"></span>
						               </button>
						               <h:outputText value="Usuario" />
						            </h5>
						         </div>
						         <div class="modal-body">
						               <h3 class="mb-3">
						                  <h:outputText value="Nome: #{usuarioAtividadeMB.usuario.nome}" />
						               </h3>
										  <ul class="list-group">
										       <li class="list-group-item no-border-rcf">
										      	  <div class="row">
											      	 <div class="col-sm-4 col-md-4 col-lg-2 col-small-4-rcf">
											        	 <h:graphicImage library="perfil" name="#{usuarioAtividadeMB.usuario.avatar}" styleClass="avatar img-circle img-thumbnail" />
											         </div>
											         <div class="col-sm-8 col-md-8 col-lg-10 col-small-8-rcf">
											        	 <p class=""><strong>Nome:</strong> #{usuarioAtividadeMB.usuario.nome}</p>
				                           				 <p class=""><strong>Contato:</strong> #{usuarioAtividadeMB.usuario.email}</p>
				                           				 <p class=""><strong>#{usuarioAtividadeMB.usuario.telefone eq null ? 'Sem contato de Telefone' : (usuarioAtividadeMB.usuario.telefone eq '' ? 'Sem contato de Telefone' : 'Telefone:')}</strong> #{usuarioAtividadeMB.usuario.telefone eq null ? '' : (usuarioAtividadeMB.usuario.telefone eq '' ? '' : usuarioAtividadeMB.usuario.telefone)}</p>
				                           				 <p class=""><strong>#{usuarioAtividadeMB.usuario.celular eq null ? 'Sem contato de Celular' : (usuarioAtividadeMB.usuario.celular eq '' ? 'Sem contato de Celular' : 'Celular:')}</strong> #{usuarioAtividadeMB.usuario.celular eq null ? '' : (usuarioAtividadeMB.usuario.celular eq '' ? '' : usuarioAtividadeMB.usuario.celular)}</p>
				                           				 <p class=""><strong>#{usuarioAtividadeMB.usuario.estado eq null ? 'Sem informação de Estado' : (usuarioAtividadeMB.usuario.estado eq '' ? 'Sem informação de Estado' : 'Estado:')}</strong> #{usuarioAtividadeMB.usuario.estado eq null ? '' : (usuarioAtividadeMB.usuario.estado eq '' ? '' : usuarioAtividadeMB.usuario.estado)}</p>
				                           				 <p class=""><strong>#{usuarioAtividadeMB.usuario.cidade eq null ? 'Sem informação de Cidade' : (usuarioAtividadeMB.usuario.cidade eq '' ? 'Sem informação de Cidade' : 'Cidade:')}</strong> #{usuarioAtividadeMB.usuario.cidade eq null ? '' : (usuarioAtividadeMB.usuario.cidade eq '' ? '' : usuarioAtividadeMB.usuario.cidade)}</p>
											         </div>
										          </div>
										       </li>
										   </ul>
						               <div class="col-md-12 col-lg-12 ui-padding-right-0-rcf">
						                  <div class="d-flex align-items-end flex-column">
								            <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
								         </div>
								       </div>
						         </div>
						         </h:form>
						      </div>
						   </div>
						</div>
             
             
             
	    </div>
	</ui:define>
</ui:composition>